jobs:
  - job: BuildWindowsWithSonarCloud
    displayName: Build for Windows\MSBuild With SonarCloud
    pool:
      vmImage: "windows-latest"
    variables:
      BUILD_WRAPPER_DOWNLOAD_URL: https://sonarcloud.io/static/cpp/build-wrapper-win-x86.zip
    steps:
      - task: SonarCloudPrepare@1  
        inputs:
          SonarCloud: "<Objetivec>"
          organization: "bpbreinerpacheco0621"
          scannerMode: "CLI"
          configMode: "manual"

      - powershell: |
          curl --create-dirs -sSLo $HOME\.sonar\build-wrapper-win-x86.zip ${{variables.BUILD_WRAPPER_DOWNLOAD_URL}}
          unzip -o $HOME\.sonar\build-wrapper-win-x86.zip -d $HOME\.sonar\
        displayName: Download and install build wrapper
      - powershell: |
          & "$HOME\.sonar\build-wrapper-win-x86\build-wrapper-win-x86-64.exe" --out-dir build_wrapper_output_directory<insert_your_clean_build_command>
        workingDirectory: .
        displayName: Build in build-wrapper
      - task: SonarCloudAnalyze@1
      - task: reportgenerator@5
        inputs:
          reports: 'coverage.xml'
          targetdir: 'coveragereport'
          sourcedirs: 'C:\Users\breinerpacheco\agent\_work\_temp'
      -task: PublishCodeCoverageResults@1
       inputs:
codeCoverageTool: 'Cobertura'
    summaryFileLocation: 'C:\Users\breinerpacheco\agent\_work\_temp\Cobertura.xml'
    pathToSources: 'C:\Users\breinerpacheco\agent\_work\_temp'
