jobs:
  - job: BuildWindowsWithSonarCloud
    displayName: Build for Windows\MSBuild With SonarCloud
    pool:
      Default
    variables:
      BUILD_WRAPPER_DOWNLOAD_URL: https://sonarcloud.io/static/cpp/build-wrapper-win-x86.zip
    steps:
      - task: SonarCloudPrepare@1  
        inputs:
          SonarCloud: "<Objetivec>"
          organization: "sonarsource-cfamily-examples"
          scannerMode: "CLI"
          configMode: "manual"

      - powershell: |
          curl --create-dirs -sSLo $HOME\.sonar\build-wrapper-win-x86.zip ${{variables.BUILD_WRAPPER_DOWNLOAD_URL}}
          unzip -o $HOME\.sonar\build-wrapper-win-x86.zip -d $HOME\.sonar\
        displayName: Download and install build wrapper
      - powershell: |
          & "$HOME\.sonar\build-wrapper-win-x86\build-wrapper-win-x86-64.exe" --out-dir build_wrapper_output_directory<insert_your_clean_build_command>
        workingDirectory: .
        displayName: Build in build-wrapper
      - task: SonarCloudAnalyze@1
      - task: SonarCloudPublish@1
        inputs:
          pollingTimeoutSec: '300'
